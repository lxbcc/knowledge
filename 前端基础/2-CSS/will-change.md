[🐻🐻🐻我只想使用will-change，又有什么错？一个老同事，前几天跟我说他挨了领导的骂，说他滥用will-ch - 掘金](https://juejin.cn/post/7254397517968867365?searchId=2024081510394040097808D6AD85E46442)

[【CSS】使用will-change来提高页面的渲染速度如果你曾经注意到过基于WebKit的浏览器在执行某些CSS操作（ - 掘金](https://juejin.cn/post/7015387929870598158?searchId=202408142348454F0776F111E4B2B8F115)
### 什么是will-change
will-change是一个css属性，它可以高速浏览器某个元素将要发生的变化，通过明确指定这些变化，浏览器可以事先分配和优化相应的资源，从而提升渲染的性能。
```css
.element {
  will-change: transform;
}
```



### will-change原理

<mark class="hltr-yellow">渲染流程简介</mark>

浏览器在渲染网页时，会经历一系列的步骤，如样式计算、布局、绘制和合成。为了提高性能，浏览器会尽量避免进行不必要的计算和操作。

will-change作用

`will-change`的作用就是告诉浏览器某个元素将要发生的变化，从而使浏览器在渲染过程中提前分配和优化相应的资源

### will-change的优化效果

使用`will-change`可以带来以下优化效果：

- 减少渲染阻塞：浏览器可以提前分配和优化资源，减少渲染阻塞时间，提高页面的响应速度。    
- 减少重绘和重排：浏览器可以更好地管理渲染过程，避免不必要的重绘和重排，从而提高渲染性能。
- 硬件加速：某些浏览器对`will-change`属性会进行硬件加速，进一步提升性能。

### `will-change`使用的时机

- 在实际更改的元素上将 will-change 设置为您将实际更改的属性。 并在他们停止时将其删除。 - Tab Atkins Jr.（规范编辑者）

- 因为will-change会消耗浏览器GPU资源

- 如果元素设置了 will-change 属性，浏览器会把这些元素提升到它们各自独立的“GPU 层”。不过呢，如果有太多元素都做了这样的声明，为了防止 GPU 内存被耗尽，浏览器就忽略这些声明。

- 在适当的时机移除will-change就是减少浏览器的复合层，避免过度使用will-change带来性能问题

### 什么操作会将元素提升到复合层

- `will-change` 属性：通过使用 `will-change` 属性，告诉浏览器该元素即将发生某种变化，浏览器可以提前将其提升到复合层以进行优化
- `transform` 属性：当使用 3D 或 2D 变换时，浏览器会自动将 `transform` 属性应用的元素提升到复合层。常见的变换函数如 `translate()`, `rotate()`, `scale()` 等
- 1. `backface-visibility` 属性：当使用 `backface-visibility: hidden` 来隐藏元素的背面时，浏览器会将该元素提升到复合层。

### 结论

will-change是一种强大的性能优化工具，在现代网页设计中发挥着重要作用。通过明确指定元素将要发生的变化，浏览器可以提前分配和优化相应的资源.

1. 不要给大量的元素添加will-change,这会导致创建大量的复合层
2. 注意使用的时机，在需要进行重绘、重排的时候，才考虑加上will-change，使用完后需要再适当的时机移除，释放浏览器资源
3. 是否真的需要will-change，如果页面在性能方面没什么问题，没有必要放个will-change来换取那微乎其微的收益，如果收益客观，可加，如果加与不加，差别不大，没必要
